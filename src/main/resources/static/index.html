<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Zenekarok és Helyszínek</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        .list-box { border: 1px solid #ccc; padding: 10px; margin-top: 15px; }
        .hidden { display: none; }
        button { padding: 10px 15px; margin-right: 10px; cursor: pointer; }
    </style>
</head>
<body>
<h1>Zenekarok és Helyszínek Kezelése</h1>

<!-- BAND BUTTONS -->
<button onclick="showBands()">Zenekarok Megjelenítése</button>
<button onclick="hideBands()">Zenekarok Elrejtése</button>

<div id="bandContainer" class="list-box hidden">
    <h2>Elérhető Zenekarok:</h2>
    <ul id="bandList">
        <li>Loading...</li>
    </ul>
</div>

<!-- LOCATION BUTTONS -->
<button onclick="showLocations()">Helyszínek Megjelenítése</button>
<button onclick="hideLocations()">Helyszínek Elrejtése</button>

<div id="locationContainer" class="list-box hidden">
    <h2>Elérhető Helyszínek:</h2>
    <ul id="locationList">
        <li>Loading...</li>
    </ul>

    <div id="locationDetails" class="hidden" style="margin-top: 15px; padding: 10px; border: 1px solid #aaa; border-radius: 5px; background: #f9f9f9;"></div>
</div>

<script>
    // BAND ELEMENTS
    const bandContainer = document.getElementById('bandContainer');
    const bandList = document.getElementById('bandList');
    let bandsLoaded = false;

    // LOCATION ELEMENTS
    const locationContainer = document.getElementById('locationContainer');
    const locationList = document.getElementById('locationList');
    const locationDetails = document.getElementById('locationDetails');
    let locationsLoaded = false;

    // FETCH BANDS
    function fetchAndRenderBands() {
        fetch('/api/bands')
            .then(response => response.json())
            .then(bands => {
                bandList.innerHTML = '';
                bands.forEach(band => {
                    const isHOC = band.bandName === "HOC";
                    const li = document.createElement('li');
                    let nameHtml = `<strong>${band.bandName}</strong>`;
                    if (isHOC) nameHtml += " (legszexibb banda ever)";

                    li.innerHTML = `Name: ${nameHtml}`;
                    bandList.appendChild(li);
                });
                bandsLoaded = true;
            })
            .catch(() => bandList.innerHTML = '<li>Hiba történt az adatok lekérdezésekor.</li>');
    }

    // FETCH LOCATIONS
    function fetchAndRenderLocations() {
        fetch('/api/locations')
            .then(response => response.json())
            .then(locations => {
                locationList.innerHTML = '';
                locations.forEach(loc => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="#" style="text-decoration:none; color:#0077cc;">${loc.locationName}</a>`;
                    li.style.cursor = 'pointer';
                    li.onclick = () => showLocationDetails(loc);
                    locationList.appendChild(li);
                });
                locationsLoaded = true;
            })
            .catch(() => locationList.innerHTML = '<li>Hiba történt az adatok lekérdezésekor.</li>');
    }

    // SHOW LOCATION DETAILS
    function showLocationDetails(loc) {
        const openMicDisplay = loc.openMic ? "Igen" : "Nem";
        const rentableDisplay = loc.rentable ? "Igen" : "Nem";

        locationDetails.classList.remove('hidden');
        locationDetails.innerHTML = `
            <h3>${loc.locationName}</h3>
            <p><strong>Cím:</strong> ${loc.address}</p>
            <p><strong>Email:</strong> ${loc.email}</p>
            <p><strong>Telefon:</strong> ${loc.phoneNum}</p>
            <p><strong>Műfaj preferencia:</strong> ${loc.genrePref}</p>
            <p><strong>Open Mic:</strong> ${openMicDisplay}</p>
            <p><strong>Bérelhető:</strong> ${rentableDisplay}</p>
            <p><strong>Férőhely:</strong> ${loc.accomodation}</p>
        `;
    }

    // BAND SHOW/HIDE
    function showBands() {
        if (!bandsLoaded) fetchAndRenderBands();
        bandContainer.classList.remove('hidden');
    }
    function hideBands() {
        bandContainer.classList.add('hidden');
    }

    // LOCATION SHOW/HIDE
    function showLocations() {
        if (!locationsLoaded) fetchAndRenderLocations();
        locationContainer.classList.remove('hidden');
    }
    function hideLocations() {
        locationContainer.classList.add('hidden');
        locationDetails.classList.add('hidden');
    }
</script>
</body>
</html>
